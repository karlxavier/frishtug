<%# Sidebar %>
<div class="meal-sidebar" v-if="shopping_cart_shown">
  <div class="meal-sidebar__header">
    <div class="col-8">
      <h5 class="text-uppercase font-size-18">Your Meals</h5>
    </div>
    <div class="col-4">
      <a href="javascript:void(0)" class="btn btn-outline-dark btn-sm font-size-12" @click="hideShoppingCart">Hide Meals</a>
    </div>
  </div>
  <div class="order-field meal-sidebar__body">
    <div class="col">
      <div class="order-list">
        <div v-if="interval !== 'month'">
          <div  v-for="order in cart" v-bind:key="`${order.id}--single`">
            <div class="row order-list-items px-3">
              <div class="col-7 px-0 text-left text-truncate">
                <strong>{{ order.name }}</strong>
              </div>
              <div class="col-3 px-0 text-center">
                <a href="javascript:void(0)"
                  class="remove-meal mx-1 chocolate-font-color"
                  :data-value="newItemJson(order)"
                  data-control-type="single"
                  data-control="remove" @click="removeToCart($event)">
                  <i class="fa fa-minus-square-o" :data-value="newItemJson(order)"
                  data-control-type="single"
                  data-control="remove"></i>
                </a>
                <span class="meal-count">{{ order.quantity }}</span>
                <a href="javascript:void(0)"
                  class="add-meal mx-1 chocolate-font-color"
                  :data-value="newItemJson(order)"
                  data-control-type="single"
                  data-control="add" @click="addToCart($event)">
                  <i class="fa fa-plus-square-o" :data-value="newItemJson(order)"
                  data-control-type="single"
                  data-control="add"></i>
                </a>
              </div>
              <div class="col-2 px-0 text-right" v-if="order.tax">
                {{ removeTaxFromPrice(order.price) | to_currency }}
              </div>
              <div class="col-2 px-0 text-right" v-else>
                {{ order.price | to_currency }}
              </div>
            </div>
            <div class="row order-list-items px-3" v-for="add_on in order.add_ons">
              <div class="col-7 px-0 text-left text-truncate">
                <strong>{{ add_on.name }}</strong>
              </div>
              <div class="col-3 px-0 text-center">
                <span class="meal-count">{{ order.quantity }}</span>
              </div>
              <div class="col-2 px-0 text-right">
                {{ add_on.price * order.quantity | to_currency }}
              </div>
            </div>
          </div>
          <div class="row order-list-items px-3" v-if="cartHasTaxableItems()">
            <div class="col-10 px-0 text-left text-truncate">
              <strong>Tax</strong>
            </div>
            <div class="col-2 px-0 text-right">
              {{ totalTaxableItemsPrice() | to_currency }}
            </div>
          </div>
          <hr>
          <div>
            <h6 class="font-weight-bold">
              Total <span class="meal-total float-right"> {{ totalPlusAddOn(cart) | to_currency }}</span>
            </h6>
          </div>
        </div>
        <div v-else>
          <div v-for="(orders, index) in cart" v-bind:key="`${index}--orders`">
            <div class="mt-3" v-for="(day, index2) in orders" v-bind:key="`${index2}--day`">
              <h6 class="text-upperclass order-title mb-0" :id="date_names[index+1]">{{ date_names[index+1] }}</h6>
              <div v-for="item in day" v-bind:key="item.id">
                <div class="row order-list-items px-3">
                  <div class="col-7 px-0 text-left text-truncate">
                    <strong>{{ item.name }}</strong>
                  </div>
                  <div class="col-3 px-0 text-center">
                    <a href="javascript:void(0)"
                      class="remove-meal mx-1 chocolate-font-color"
                      :data-value="newItemJson(item)"
                      :data-control-type="index"
                      data-control="remove" @click="removeToCart($event)">
                      <i class="fa fa-minus-square-o" :data-value="newItemJson(item)"
                      :data-control-type="index"
                      data-control="remove"></i>
                    </a>
                    <span class="meal-count">{{ item.quantity }}</span>
                    <a href="javascript:void(0)"
                      class="add-meal mx-1 chocolate-font-color"
                      :data-value="newItemJson(item)"
                      :data-control-type="index"
                      data-control="add" @click="addToCart($event)">
                      <i class="fa fa-plus-square-o" :data-value="newItemJson(item)"
                      :data-control-type="index"
                      data-control="add"></i>
                    </a>
                  </div>
                  <div class="col-2 px-0 text-right" v-if="item.tax">
                    {{ removeTaxFromPrice(item.price) | to_currency }}
                  </div>
                  <div class="col-2 px-0 text-right" v-else>
                    {{ item.price | to_currency }}
                  </div>
                </div>
                <div class="row order-list-items px-3" v-for="add_on in item.add_ons">
                  <div class="col-7 px-0 text-left text-truncate">
                    <strong>{{ add_on.name }}</strong>
                  </div>
                  <div class="col-3 px-0 text-center">
                    <span class="meal-count">{{ item.quantity }}</span>
                  </div>
                  <div class="col-2 px-0 text-right">
                    {{ add_on.price * item.quantity | to_currency }}
                  </div>
                </div>
              </div>
              <div class="row order-list-items px-3" v-if="cartHasTaxableItems(day)">
                <div class="col-10 px-0 text-left text-truncate">
                  <strong>Tax</strong>
                </div>
                <div class="col-2 px-0 text-right">
                  {{ totalTaxableItemsPrice(day) | to_currency }}
                </div>
              </div>
              <hr>
              <div>
                <h6 class="font-weight-bold">
                  Total <span class="meal-total float-right mb-4"> {{ totalPlusAddOn(day) | to_currency }} </span>
                </h6>
              </div>
              <div v-if="totalPlusAddOn(day) > plan_limit">
                <small class="alert alert-warning d-flex" style="font-size: 9px; width: 100%;">
                  <i class="fa fa-exclamation-circle font-size-24 pr-1" aria-hidden="true"></i>
                  You have exceeded your plan limit of $ {{ plan_limit }} for {{ index | get_num | get_date_name }}.
                  Any excess will be charge directly to your account.
                </small>
              </div>
              <div v-if="hasAvailableCredit(totalPlusAddOn(day))">
                <small class="alert alert-info d-flex" style="font-size: 10px; width: 100%;">
                  <i class="fa fa-info-circle font-size-24 pr-1" aria-hidden="true"></i>
                  Order not finished, because you still have $ {{ (plan_limit - totalPlusAddOn(day)).toFixed(2) }} credits available
                  for {{ index | get_num | get_date_name }}.
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="meal-sidebar__bottom_addon">
    <p class="font-size-12 font-family-lato">
      <strong>NOTE:</strong> Group Discount will be applied upon <br>
      acceptance by other group members. Your card will <br>
      not be charged until the others complete their orders.
    </p>
  </div>
  <div class="meal-sidebar__footer">
    <div class="col">
      <a href="javascript:void(0)" class="btn btn-brown btn--save-meal-plan btn-block" @click="showCongrats">
        Save Meal Plan
      </a>
    </div>
  </div>
</div>
